{% extends "lyricsnest/base.html" %}

{% block content %}
    
    <div class="w-full flex space-between items-align justify-center mb-15">
        <div class="flex flex-col bg-gray-50 border-1 border-gray-300 rounded-lg p-4 w-3xs items-center justify-between mx-5">
            <h1 class="text-lg font-semibold my-2">Import lyrics</h1>
            <span class="text-center text-gray-600 my-4">Import a text file with your existing lyrics</span>
            <form class="flex flex-col w-full my-2" method="POST" action="{% url 'lyricsnest:import' %}" enctype="multipart/form-data">
                {% csrf_token %}
                <label for="file" class="flex justify-center w-full btn btn-gray items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5 mr-2">
                        <path d="M3 3.5A1.5 1.5 0 0 1 4.5 2h6.879a1.5 1.5 0 0 1 1.06.44l4.122 4.12A1.5 1.5 0 0 1 17 7.622V16.5a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 3 16.5v-13Z" />
                    </svg>
                    Select file
                </label>
                <span id="filename" class="w-full text-ellipsis"></span>
                <input type="file" id="file" name="file" class="hidden" accept=".txt" />
                <button id="import-btn"
                    class="hidden w-full btn btn-blue flex items-align justify-center"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5 mr-2">
                        <path d="M9.25 13.25a.75.75 0 0 0 1.5 0V4.636l2.955 3.129a.75.75 0 0 0 1.09-1.03l-4.25-4.5a.75.75 0 0 0-1.09 0l-4.25 4.5a.75.75 0 1 0 1.09 1.03L9.25 4.636v8.614Z" />
                        <path d="M3.5 12.75a.75.75 0 0 0-1.5 0v2.5A2.75 2.75 0 0 0 4.75 18h10.5A2.75 2.75 0 0 0 18 15.25v-2.5a.75.75 0 0 0-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5Z" />
                    </svg>
                    Import
                </button>
            </form>
        </div>
        <div class="flex flex-col bg-gray-50 border-1 border-gray-300 rounded-lg p-4 w-3xs items-center justify-between mx-5">
            <h1 class="text-lg font-semibold my-2">Write your own lyrics</h1>
            <span class="text-center text-gray-600 my-4">Write your own lyrics, you can still complete them with IA</span>
            <a href="{% url 'lyricsnest:create-song' %}" class="w-full my-2">
                <button 
                    class="w-full btn btn-blue flex justify-center items-center"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5 mr-2">
                        <path d="m2.695 14.762-1.262 3.155a.5.5 0 0 0 .65.65l3.155-1.262a4 4 0 0 0 1.343-.886L17.5 5.501a2.121 2.121 0 0 0-3-3L3.58 13.419a4 4 0 0 0-.885 1.343Z" />
                    </svg>
                    Write yourself
                </button>
            </a>
        </div>
        <div class="flex flex-col bg-gray-50 border-1 border-gray-300 rounded-lg p-4 w-3xs items-center justify-between mx-5">
            <h1 class="text-lg font-semibold my-2">Generat with AI</h1>
            <span class="text-center text-gray-600 my-4">Give a global or precise context and parameters, and let the AI generate the perfect lyrics</span>
            <a href="{% url 'lyricsnest:generate' %}" class="w-full my-2">
                <button 
                    class="w-full btn btn-purple flex items-center justify-center"
                >
                    <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5 mr-2">
                        <path fill-rule="evenodd" d="M3.25 3A2.25 2.25 0 0 0 1 5.25v9.5A2.25 2.25 0 0 0 3.25 17h13.5A2.25 2.25 0 0 0 19 14.75v-9.5A2.25 2.25 0 0 0 16.75 3H3.25Zm.943 8.752a.75.75 0 0 1 .055-1.06L6.128 9l-1.88-1.693a.75.75 0 1 1 1.004-1.114l2.5 2.25a.75.75 0 0 1 0 1.114l-2.5 2.25a.75.75 0 0 1-1.06-.055ZM9.75 10.25a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5h-2.5Z" clip-rule="evenodd" />
                    </svg> -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5 mr-2">
                        <path d="M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785l-.238-1.192ZM6.949 5.684a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633L6.95 5.684ZM13.949 13.684a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632l-.183-.551Z" />
                    </svg>
                    Generate
                </button>
            </a>
        </div>
    </div>

    <div class="w-full flex flex-col mb-15">
        <h1 class="text-3xl font-semibold mb-10 mx-5">Latest lyrics</h1>
        <div class="w-full flex">
            {% for song in songs %}
                <a href="{% url 'lyricsnest:edit-song' pk=song.id %}" class="mx-5 flex items-stretch hover:shadow">
                    <div class="flex flex-col border-1 border-gray-300 rounded bg-gray-50 p-4 w-3xs">
                        <span class="text-lg font-semibold mb-5">
                            {{ song.title }}
                        </span>
                        <div class="text-justify wrap-break-word">
                            {{ song.lyrics | slice:":80" | linebreaksbr }} [...]
                        </div>
                        <!-- <div class="flex items-center justify-end mt-4">
                            <a href="{% url 'lyricsnest:edit-song' pk=song.id %}"><button class="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline cursor-pointer">Edit</button></a>
                            <a href="{% url 'lyricsnest:delete-song' pk=song.id %}" onclick="return confirm('Delete this lyrics ?')"><button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline cursor-pointer">Delete</button></a>
                        </div> -->
                    </div>
                </a>
            {% empty %}
                <p class="mx-5">No lyrics yet !</p>
            {% endfor %}
        </div>
    </div>

{% endblock %}

{% block scripts %}
<script>
    document.getElementById('file').addEventListener('change', (e) => {
        const filename = document.getElementById('filename')
        filename.innerHTML = e.target.files[0]?.name || ""
        
        const importBtn = document.getElementById('import-btn')
        if (e.target.files.length > 0) {
            importBtn.classList.remove('hidden')
        } else {
            importBtn.classList.add('hidden')
        }
    })
</script>
{% endblock %}